name: Windows - H2S - CM - APP

on:
  workflow_dispatch:
    # --- ADDED THIS SECTION ---
    # You must define the inputs you want to use.
    inputs:
      settings_url:
        description: 'The full URL for the general.cfg file'
        required: true
        
      urls:
        description: 'The Pastebin URL for the list of download links'
        required: true
        

jobs:
  build:
    name: Start Building...
    runs-on: windows-latest

    steps:
      - name: Install dependencies
        shell: pwsh
        run: | 
          python -m pip install --upgrade pip setuptools wheel
          python -m pip install google-api-python-client>=2.0.0 google-auth-httplib2>=0.1.0 google-auth-oauthlib>=0.4.0
          python -m pip install yagmail chardet wheel oauth2client
          python -m pip install git+https://github.com/monsterhunters/srtmerge.git --no-build-isolation

      - name: Downloading & Running Essentials
        shell: pwsh
        # --- MOVED THE ENV BLOCK HERE ---
        # These variables are now available to your .bat script
        env:
          SETTING: ${{ inputs.settings_url }}
          LINK_LIST_URL: ${{ inputs.urls }}
        
        run: |
          Invoke-WebRequest -Uri "https://raw.githubusercontent.com/Bogyi2024/log/main/directcm720custom-next.bat" -OutFile "directcm720custom-next.bat"
          
          # This .bat script will now have access to %SETTING% and %LINK_LIST_URL%
          cmd /c directcm720custom-next.bat
